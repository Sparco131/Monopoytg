<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мини-Монополия</title>
    <style>
        /* Общие стили */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            box-sizing: border-box;
        }

        h1 {
            color: #333;
            font-size: 24px;
            margin: 10px 0;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            width: 100%;
            max-width: 300px;
            margin-bottom: 15px;
        }

        .cell {
            border: 1px solid #000;
            padding: 10px;
            text-align: center;
            background-color: #f0f0f0;
            border-radius: 5px;
            font-size: 14px;
        }

        .cell.start {
            background-color: #aaffaa;
        }

        .cell.property {
            background-color: #ffcc99;
        }

        .cell.jail {
            background-color: #ffaaaa;
        }

        .player-info {
            margin-bottom: 15px;
            text-align: center;
            font-size: 16px;
        }

        .player-info p {
            margin: 5px 0;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            max-width: 300px;
        }

        .actions button {
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #007bff;
            color: #fff;
            cursor: pointer;
        }

        .actions button:hover {
            background-color: #0056b3;
        }

        .log {
            width: 100%;
            max-width: 300px;
            height: 100px;
            border: 1px solid #000;
            padding: 10px;
            overflow-y: auto;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-top: 15px;
            font-size: 14px;
        }

        .log p {
            margin: 0;
        }
    </style>
</head>
<body>
    <h1>Мини-Монополия</h1>
    <div class="board">
        <div class="cell start">Старт</div>
        <div class="cell property">Улица 1</div>
        <div class="cell property">Улица 2</div>
        <div class="cell jail">Тюрьма</div>
        <div class="cell property">Улица 3</div>
        <div class="cell property">Улица 4</div>
    </div>

    <div class="player-info">
        <h2>Игрок</h2>
        <p>Деньги: $<span id="money">1500</span></p>
        <p>Собственность: <span id="properties">Нет</span></p>
        <p>Позиция: <span id="position">Старт</span></p>
    </div>

    <div class="actions">
        <button onclick="rollDice()">Бросить кубик</button>
        <button onclick="buyProperty()">Купить собственность</button>
        <button onclick="buildHouse()">Построить дом</button>
    </div>

    <div class="log" id="log">
        <p>Добро пожаловать в игру!</p>
    </div>

    <script>
        // Инициализация данных игры
        const board = [
            { name: "Старт", type: "start", price: 0, owner: null, houses: 0 },
            { name: "Улица 1", type: "property", price: 200, owner: null, houses: 0 },
            { name: "Улица 2", type: "property", price: 200, owner: null, houses: 0 },
            { name: "Тюрьма", type: "jail", price: 0, owner: null, houses: 0 },
            { name: "Улица 3", type: "property", price: 300, owner: null, houses: 0 },
            { name: "Улица 4", type: "property", price: 300, owner: null, houses: 0 },
        ];

        const player = {
            money: 1500,
            position: 0,
            properties: [],
            inJail: false,
        };

        // Элементы DOM
        const moneyElement = document.getElementById("money");
        const propertiesElement = document.getElementById("properties");
        const positionElement = document.getElementById("position");
        const logElement = document.getElementById("log");

        // Обновление информации об игроке
        function updatePlayerInfo() {
            moneyElement.textContent = player.money;
            propertiesElement.textContent = player.properties.join(", ") || "Нет";
            positionElement.textContent = board[player.position].name;
        }

        // Добавление сообщения в лог
        function addLogMessage(message) {
            const p = document.createElement("p");
            p.textContent = message;
            logElement.appendChild(p);
            logElement.scrollTop = logElement.scrollHeight;
        }

        // Бросок кубика
        function rollDice() {
            if (player.inJail) {
                addLogMessage("Вы в тюрьме и не можете бросить кубик!");
                return;
            }

            const dice = Math.floor(Math.random() * 6) + 1;
            player.position = (player.position + dice) % board.length;
            const cell = board[player.position];

            addLogMessage(`Вы бросили кубик и выпало ${dice}. Вы на клетке: ${cell.name}`);

            if (cell.type === "jail") {
                player.inJail = true;
                addLogMessage("Вы попали в тюрьму!");
            } else if (cell.type === "property" && cell.owner !== null && cell.owner !== "player") {
                const rent = cell.price * 0.1;
                player.money -= rent;
                addLogMessage(`Вы заплатили аренду: $${rent}`);
            }

            updatePlayerInfo();
        }

        // Покупка собственности
        function buyProperty() {
            const cell = board[player.position];
            if (cell.type !== "property" || cell.owner !== null) {
                addLogMessage("Покупка невозможна.");
                return;
            }

            if (player.money >= cell.price) {
                cell.owner = "player";
                player.money -= cell.price;
                player.properties.push(cell.name);
                addLogMessage(`Вы купили ${cell.name} за $${cell.price}`);
            } else {
                addLogMessage("Недостаточно денег для покупки.");
            }

            updatePlayerInfo();
        }

        // Постройка дома
        function buildHouse() {
            const cell = board[player.position];
            if (cell.owner !== "player" || player.money < 100) {
                addLogMessage("Постройка невозможна.");
                return;
            }

            cell.houses += 1;
            player.money -= 100;
            addLogMessage(`Вы построили дом на ${cell.name} за $100`);
            updatePlayerInfo();
        }

        // Инициализация игры
        updatePlayerInfo();

        // Интеграция с Telegram WebApp
        Telegram.WebApp.ready();
        Telegram.WebApp.expand(); // Раскрыть приложение на весь экран
    </script>
</body>
</html>
