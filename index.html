<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Monopoly</title>
    <style>
        /* Общие стили */
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }

        /* Контейнер для меню */
        .menu-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 100%;
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .menu-container h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .menu-container label {
            display: block;
            margin: 15px 0 5px;
            font-weight: bold;
            color: rgba(255, 255, 255, 0.8);
            text-align: left;
        }

        .menu-container select,
        .menu-container input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 20px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: border-color 0.3s ease, background 0.3s ease;
        }

        .menu-container select:hover,
        .menu-container input:hover {
            border-color: rgba(255, 255, 255, 0.5);
        }

        .menu-container select:focus,
        .menu-container input:focus {
            border-color: #6a11cb;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
        }

        .menu-container button {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .menu-container button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .menu-container button:active {
            transform: translateY(0);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        /* Анимация фона */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 10%, transparent 10.01%);
            background-size: 20px 20px;
            animation: moveBackground 10s linear infinite;
            z-index: -1;
        }

        @keyframes moveBackground {
            from {
                transform: translateY(0) translateX(0);
            }
            to {
                transform: translateY(-100%) translateX(-100%);
            }
        }

        /* Контейнер для игрового поля */
        .board-container {
            display: none; /* Скрываем поле по умолчанию */
            width: 100%;
            max-width: 600px;
            aspect-ratio: 1;
            position: relative;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin-top: 20px; /* Отступ сверху */
        }

        /* Игровое поле */
        .board {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(12, 1fr); /* 12 столбцов */
            grid-template-rows: repeat(12, 1fr); /* 12 строк */
            background: #f0f0f0;
            box-sizing: border-box;
        }

        /* Стили для клеток */
        .cell {
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ddd;
            font-size: 10px;
            text-align: center;
            padding: 2px;
            box-sizing: border-box;
            background: white;
            color: #333;
            transition: background 0.3s ease;
        }

        .cell:hover {
            background: #f9f9f9;
        }

        /* Угловые клетки */
        .corner {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            font-weight: bold;
            font-size: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 5px;
            box-sizing: border-box;
        }

        /* Стили для клетки "Лотерея" */
        .cell.lottery {
            background: #ffcc00; /* Желтый цвет */
            color: black;
            font-weight: bold;
        }

        /* Свойства */
        .property {
            background: #e0f7fa; /* Светло-голубой */
            color: #333;
        }

        /* Игроки */
        .player {
            position: absolute;
            width: 4%;
            height: 4%;
            border-radius: 50%;
            transition: all 0.5s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        #player1 {
            background: #ff6b6b; /* Красный */
        }

        #player2 {
            background: #4ecdc4; /* Бирюзовый */
        }

        #player3 {
            background: #ffe66d; /* Желтый */
        }

        #player4 {
            background: #ff9f43; /* Оранжевый */
        }

        /* Контейнер для кубиков и кнопки */
        .dice-controls {
            display: none; /* Скрываем по умолчанию */
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px; /* Отступ сверху */
            margin-bottom: 20px; /* Отступ снизу */
        }

        /* Кубики */
        .dice {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 2px solid #333;
            border-radius: 10px;
            text-align: center;
            line-height: 50px;
            font-size: 24px;
            background: white;
            color: #333;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        /* Кнопка броска */
        .roll-button {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .roll-button:hover {
            background: linear-gradient(135deg, #2575fc, #6a11cb);
        }

        /* Адаптация для мобильных устройств */
        @media (max-width: 600px) {
            .menu-container {
                padding: 20px;
                border-radius: 15px;
            }

            .menu-container h1 {
                font-size: 2rem;
            }

            .menu-container button {
                padding: 12px 25px;
                font-size: 1rem;
            }

            .cell {
                font-size: 8px;
                padding: 1px;
            }

            .corner {
                font-size: 10px;
            }

            .board-container {
                max-width: 100%;
                border-radius: 0;
                margin-top: 10px;
            }

            .dice {
                width: 40px;
                height: 40px;
                font-size: 20px;
                line-height: 40px;
            }

            .roll-button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .dice-controls {
                gap: 10px;
                margin-top: 10px;
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Меню -->
    <div class="menu-container" id="menu">
        <h1>Modern Monopoly</h1>
        <label for="mode">Выберите режим:</label>
        <select id="mode">
            <option value="classic">Классический</option>
            <option value="fast">Быстрый</option>
        </select>

        <label for="players">Количество игроков (включая ботов):</label>
        <input type="number" id="players" min="1" max="4" value="2">

        <button onclick="startGame()">Начать игру</button>
    </div>

    <!-- Игровое поле -->
    <div class="board-container" id="board-container">
        <div class="board">
            <!-- Угловые клетки -->
            <div class="cell corner" style="grid-column: 1 / 2; grid-row: 1 / 2;">Старт</div> <!-- Верхний левый угол -->
            <div class="cell corner" style="grid-column: 12 / 13; grid-row: 1 / 2;">Идите в тюрьму</div> <!-- Верхний правый угол -->
            <div class="cell corner" style="grid-column: 12 / 13; grid-row: 12 / 13;">Бесплатная парковка</div> <!-- Правый нижний угол -->
            <div class="cell corner" style="grid-column: 1 / 2; grid-row: 12 / 13;">Тюрьма</div> <!-- Левый нижний угол -->

            <!-- Остальные клетки -->
            <div class="cell property" style="grid-column: 3 / 4; grid-row: 12 / 13;">Улица 1 (60$)</div>
            <div class="cell property" style="grid-column: 4 / 5; grid-row: 12 / 13;">Улица 2 (60$)</div>
            <div class="cell property" style="grid-column: 5 / 6; grid-row: 12 / 13;">Улица 3 (100$)</div>
            <div class="cell property" style="grid-column: 6 / 7; grid-row: 12 / 13;">Улица 4 (100$)</div>
            <div class="cell property" style="grid-column: 7 / 8; grid-row: 12 / 13;">Улица 5 (140$)</div>
            <div class="cell property" style="grid-column: 8 / 9; grid-row: 12 / 13;">Улица 6 (140$)</div>
            <div class="cell property" style="grid-column: 9 / 10; grid-row: 12 / 13;">Улица 7 (180$)</div>
            <div class="cell property" style="grid-column: 10 / 11; grid-row: 12 / 13;">Улица 8 (220$)</div>

            <!-- Левая сторона (снизу вверх) -->
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 10 / 11;">Железная дорога 1 (200$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 9 / 10;">Железная дорога 2 (200$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 8 / 9;">Железная дорога 3 (200$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 7 / 8;">Железная дорога 4 (200$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 6 / 7;">Электростанция (150$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 5 / 6;">Водоканал (150$)</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 4 / 5;">Шанс</div>
            <div class="cell property" style="grid-column: 1 / 2; grid-row: 3 / 4;">Общественная казна</div>

            <!-- Верхняя сторона (справа налево) -->
            <div class="cell property" style="grid-column: 3 / 4; grid-row: 1 / 2;">Улица 9 (240$)</div>
            <div class="cell property" style="grid-column: 4 / 5; grid-row: 1 / 2;">Улица 10 (260$)</div>
            <div class="cell property" style="grid-column: 5 / 6; grid-row: 1 / 2;">Улица 11 (280$)</div>
            <div class="cell property" style="grid-column: 6 / 7; grid-row: 1 / 2;">Улица 12 (300$)</div>
            <div class="cell property" style="grid-column: 7 / 8; grid-row: 1 / 2;">Налог (200$)</div>
            <div class="cell property" style="grid-column: 8 / 9; grid-row: 1 / 2;">Налог (100$)</div>
            <div class="cell property" style="grid-column: 9 / 10; grid-row: 1 / 2;">Улица 13 (320$)</div>
            <div class="cell property" style="grid-column: 10 / 11; grid-row: 1 / 2;">Улица 14 (350$)</div>

            <!-- Правая сторона (сверху вниз) -->
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 3 / 4;">Шанс</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 4 / 5;">Общественная казна</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 5 / 6;">Электростанция (150$)</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 6 / 7;">Водоканал (150$)</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 7 / 8;">Железная дорога 1 (200$)</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 8 / 9;">Железная дорога 2 (200$)</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 9 / 10;">Железная дорога 3 (200$)</div>
            <div class="cell property" style="grid-column: 12 / 13; grid-row: 10 / 11;">Железная дорога 4 (200$)</div>

            <!-- Игроки -->
            <div id="player1" class="player"></div>
            <div id="player2" class="player"></div>
            <div id="player3" class="player"></div>
            <div id="player4" class="player"></div>
        </div>
    </div>

    <!-- Кубики и кнопка броска -->
    <div class="dice-controls" id="dice-controls">
        <div id="dice1" class="dice">1</div>
        <div id="dice2" class="dice">1</div>
        <button class="roll-button" onclick="rollDice()">Бросить кубики</button>
    </div>

    <script>
        // Элементы меню и поля
        const menu = document.getElementById('menu');
        const boardContainer = document.getElementById('board-container');
        const diceControls = document.getElementById('dice-controls');
        const dice1Element = document.getElementById('dice1');
        const dice2Element = document.getElementById('dice2');

        // Игроки и боты
        let players = [];
        let currentPlayerIndex = 0;

        // Начало игры
        function startGame() {
            const mode = document.getElementById('mode').value;
            const playersCount = parseInt(document.getElementById('players').value);

            // Скрываем меню и показываем поле и кубики
            menu.style.display = 'none';
            boardContainer.style.display = 'block';
            diceControls.style.display = 'flex'; // Показываем кубики и кнопку

            // Инициализация игры
            initGame(mode, playersCount);

            // Заменяем случайную клетку на "Лотерея"
            replaceRandomCellWithLottery();
        }

        // Инициализация игры
        function initGame(mode, playersCount) {
            players = [];
            for (let i = 1; i <= playersCount; i++) {
                players.push({
                    id: `player${i}`,
                    position: 0,
                    money: 1500,
                    isBot: i > 1, // Первый игрок — человек, остальные — боты
                    properties: [],
                });
            }

            // Начинаем игру с первого игрока
            currentPlayerIndex = 0;
            if (players[currentPlayerIndex].isBot) {
                botTurn();
            }
        }

        // Ход бота
        function botTurn() {
            setTimeout(() => {
                const bot = players[currentPlayerIndex];
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                const steps = dice1 + dice2;

                movePlayer(bot, steps);
                console.log(`Бот ${bot.id} бросил кубики: ${dice1} и ${dice2}, шаги: ${steps}`);

                // Переход хода
                nextTurn();
            }, 1000); // Задержка для имитации "думающего" бота
        }

        // Переход хода
        function nextTurn() {
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
            if (players[currentPlayerIndex].isBot) {
                botTurn();
            }
        }

        // Функция для броска кубиков
        function rollDice() {
            const currentPlayer = players[currentPlayerIndex];
            if (currentPlayer.isBot) return; // Человек не может ходить за бота

            let dice1 = 0, dice2 = 0;
            const interval = setInterval(() => {
                dice1 = Math.floor(Math.random() * 6) + 1;
                dice2 = Math.floor(Math.random() * 6) + 1;
                dice1Element.textContent = dice1;
                dice2Element.textContent = dice2;
            }, 100);

            setTimeout(() => {
                clearInterval(interval);
                const steps = dice1 + dice2;
                movePlayer(currentPlayer, steps);
                console.log(`Игрок ${currentPlayer.id} бросил кубики: ${dice1} и ${dice2}, шаги: ${steps}`);
                nextTurn();
            }, 2000);
        }

        // Функция для перемещения игрока
        function movePlayer(player, steps) {
            const newPosition = (player.position + steps) % 40;
            player.position = newPosition;

            // Обновляем позицию на поле
            const playerElement = document.getElementById(player.id);
            const board = document.querySelector('.board');
            const cellSize = board.offsetWidth / 12;
            const cell = getCellPosition(newPosition);
            playerElement.style.left = `${cell.x * cellSize}px`;
            playerElement.style.top = `${cell.y * cellSize}px`;

            // Обработка клетки
            const currentCell = document.querySelector(`.cell[style*="grid-column: ${cell.x + 1} / ${cell.x + 2}"][style*="grid-row: ${cell.y + 1} / ${cell.y + 2}"]`);
            if (currentCell.classList.contains('lottery')) {
                handleLotteryCell(player);
            } else {
                handleCellAction(player, newPosition);
            }
        }

        // Обработка действий на клетке
        function handleCellAction(player, position) {
            const cell = getCellData(position);
            if (cell.type === "property" && !cell.owner) {
                if (player.money >= cell.price) {
                    player.money -= cell.price;
                    player.properties.push(cell);
                    cell.owner = player;
                    console.log(`${player.id} купил ${cell.name} за ${cell.price}$`);
                }
            } else if (cell.type === "property" && cell.owner && cell.owner !== player) {
                const rent = cell.rent;
                player.money -= rent;
                cell.owner.money += rent;
                console.log(`${player.id} заплатил аренду ${cell.owner.id} в размере ${rent}$`);
            } else if (cell.type === "tax") {
                player.money -= cell.amount;
                console.log(`${player.id} заплатил налог в размере ${cell.amount}$`);
            } else if (cell.type === "chance") {
                const chanceCard = drawChanceCard();
                console.log(`${player.id} вытянул карточку Шанс: ${chanceCard}`);
            } else if (cell.type === "community_chest") {
                const communityChestCard = drawCommunityChestCard();
                console.log(`${player.id} вытянул карточку Общественной казны: ${communityChestCard}`);
            }
        }

        // Получение данных о клетке
        function getCellData(index) {
            const cells = [
                { type: "start", name: "Старт" },
                { type: "property", name: "Улица 1", price: 60, rent: 10 },
                { type: "property", name: "Улица 2", price: 60, rent: 10 },
                { type: "property", name: "Улица 3", price: 100, rent: 20 },
                { type: "property", name: "Улица 4", price: 100, rent: 20 },
                { type: "property", name: "Улица 5", price: 140, rent: 30 },
                { type: "property", name: "Улица 6", price: 140, rent: 30 },
                { type: "property", name: "Улица 7", price: 180, rent: 40 },
                { type: "railroad", name: "Железная дорога 1", price: 200, rent: 50 },
                { type: "railroad", name: "Железная дорога 2", price: 200, rent: 50 },
                { type: "railroad", name: "Железная дорога 3", price: 200, rent: 50 },
                { type: "railroad", name: "Железная дорога 4", price: 200, rent: 50 },
                { type: "utility", name: "Электростанция", price: 150, rent: 25 },
                { type: "utility", name: "Водоканал", price: 150, rent: 25 },
                { type: "chance", name: "Шанс" },
                { type: "community_chest", name: "Общественная казна" },
                { type: "tax", name: "Налог", amount: 200 },
                { type: "tax", name: "Налог", amount: 100 },
                { type: "jail", name: "Тюрьма" },
                { type: "free_parking", name: "Бесплатная парковка" },
                { type: "go_to_jail", name: "Идите в тюрьму" },
                { type: "property", name: "Улица 8", price: 220, rent: 45 },
                { type: "property", name: "Улица 9", price: 240, rent: 50 },
                { type: "property", name: "Улица 10", price: 260, rent: 55 },
                { type: "property", name: "Улица 11", price: 280, rent: 60 },
                { type: "property", name: "Улица 12", price: 300, rent: 65 },
            ];
            return cells[index];
        }

        // Получение координат клетки
        function getCellPosition(index) {
            const positions = [
                { x: 0, y: 0 },    // Старт (верхний левый угол)
                { x: 1, y: 0 },    // Улица 1
                { x: 2, y: 0 },    // Улица 2
                { x: 3, y: 0 },    // Улица 3
                { x: 4, y: 0 },    // Улица 4
                { x: 5, y: 0 },    // Улица 5
                { x: 6, y: 0 },    // Улица 6
                { x: 7, y: 0 },    // Улица 7
                { x: 8, y: 0 },    // Железная дорога 1
                { x: 9, y: 0 },    // Железная дорога 2
                { x: 10, y: 0 },   // Железная дорога 3
                { x: 11, y: 0 },   // Железная дорога 4
                { x: 11, y: 1 },   // Электростанция
                { x: 11, y: 2 },   // Водоканал
                { x: 11, y: 3 },   // Шанс
                { x: 11, y: 4 },   // Общественная казна
                { x: 11, y: 5 },   // Налог (200$)
                { x: 11, y: 6 },   // Налог (100$)
                { x: 11, y: 7 },   // Идите в тюрьму (верхний правый угол)
                { x: 11, y: 10 },  // Бесплатная парковка (правый нижний угол)
                { x: 0, y: 10 },   // Тюрьма (левый нижний угол)
                { x: 9, y: 10 },   // Улица 8
                { x: 8, y: 10 },   // Улица 9
                { x: 7, y: 10 },   // Улица 10
                { x: 6, y: 10 },   // Улица 11
                { x: 5, y: 10 },   // Улица 12
            ];
            return positions[index];
        }

        // Функция для замены случайной клетки на "Лотерея"
        function replaceRandomCellWithLottery() {
            const cells = document.querySelectorAll('.cell:not(.corner)'); // Все клетки, кроме угловых
            const randomIndex = Math.floor(Math.random() * cells.length); // Случайный индекс
            const randomCell = cells[randomIndex];

            // Заменяем содержимое клетки
            randomCell.classList.add('lottery');
            randomCell.textContent = 'Лотерея';
        }

        // Функция для обработки попадания на клетку "Лотерея"
        function handleLotteryCell(player) {
            const outcomes = [
                { text: "Вы выиграли 100$!", amount: 100 },
                { text: "Вы выиграли 200$!", amount: 200 },
                { text: "Вы проиграли 50$!", amount: -50 },
                { text: "Вы проиграли 100$!", amount: -100 },
            ];

            // Выбираем случайный исход
            const outcome = outcomes[Math.floor(Math.random() * outcomes.length)];
            player.money += outcome.amount;

            // Выводим сообщение
            console.log(`${player.id} попал на Лотерею: ${outcome.text}`);
            alert(`${player.id} попал на Лотерею: ${outcome.text}`);
        }

        // Карточки Шанс
        function drawChanceCard() {
            const cards = [
                "Получите 100$",
                "Перейдите на старт",
                "Отправьтесь в тюрьму",
                "Заплатите 50$",
            ];
            return cards[Math.floor(Math.random() * cards.length)];
        }

        // Карточки Общественной казны
        function drawCommunityChestCard() {
            const cards = [
                "Получите 200$",
                "Заплатите 100$",
                "Перейдите на старт",
                "Отправьтесь в тюрьму",
            ];
            return cards[Math.floor(Math.random() * cards.length)];
        }
    </script>
</body>
</html>
